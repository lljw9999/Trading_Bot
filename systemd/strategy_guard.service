[Unit]
Description=Per-strategy Guardrails
After=network.target
Wants=redis.service

[Service]
Type=simple
ExecStart=/usr/bin/python3 /opt/trader/services/strategy_guard.py --run
Restart=always
RestartSec=10
User=trader
Group=trader
Environment=PYTHONPATH=/opt/trader
Environment=REDIS_URL=redis://localhost:6379
StandardOutput=journal
StandardError=journal

# Resource limits
MemoryMax=256M
CPUQuota=25%

# Security
PrivateTmp=true
ProtectHome=true
ProtectSystem=strict
ReadWritePaths=/opt/trader/logs /opt/trader/data
NoNewPrivileges=true

[Install]
WantedBy=multi-user.target